extends layouts/layout

block content
  h1 Чат
  p Привет #{user.username}!
  ul#messages
  form(id="form")
    input(id="input" autocomplete="off" autofocus placeholder="Message...")
    button.btn.btn-primary Send
  script.
    var socket = io();
    var form = $('#form');
    var ul = $('#messages');

    function printMsg(msg) {
      $('<li>', { text: msg }).appendTo(ul);
    }

    form.submit(function() {
      var input = $(this).find('#input');
      var text = input.val();
      input.val('');
      socket.emit('message', text, function(data) {
        console.log(data);
        printMsg(text);
      });
      return false;
    });

    socket.on('message', function(text) {
      printMsg(text);
    });

    socket.on('connect', function() {
      printMsg('Соединение настроено');
    });

    socket.on('disconnect', function() {
      printMsg('Соединение потеряно');
    });

